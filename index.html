<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!---------------------------   ####     ##      ####             #######   ####     ####      ##      #### ----------------------------->
<!---------------------------  ##  ##   ####      ##                   ##  ##  ##     ##      ####    ##  ##----------------------------->
<!--------------------------- ##        ## ##     ##                  ##   ##   ##    ##      ## ##   ##   ##---------------------------->
<!---------------------------  #####   ##   ##    ##                 ##    ##   ##    ##     ##   ##  ##   ##---------------------------->
<!---------------------------      ##  #######    ##                ##     ##   ##    ##     #######  ##   ##---------------------------->
<!--------------------------- ##   ##  ##   ##    ##               ##      ##   ##    ##     ##   ##  ##   ##---------------------------->
<!---------------------------  #####   ##   ##   ####             #######   #####    ####    ##   ##   #####----------------------------->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->


    
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <title>Izao e Jhow</title>
  <link rel="icon" type="image/x-icon" href="images/nois.jpeg">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ch√° de Casa Nova</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="casanova.css">
</head>
<body>
    <header>
        <div class="header-content">
            <img src="images/nois.jpeg" alt="Nois" class="personal-photo">
            <div class="header-text">
                <h1>Ch√° de Casa Nova</h1>
                <p>Lista de Presentes</p>
                <button id="desvincular-button">Desvincular Produto</button>
            </div>
        </div>
    </header>
    
    <main>
        <section class="product-list">
            <div class="product-item" data-id="1">
                <img src="images/batedeira.png" alt="Batedeira Branca">
                <h2>Batedeira Branca</h2>
                <button class="link-button">Vincular</button>
            </div>
            
            <div class="product-item" data-id="2">
                <img src="images/liquidificador.png" alt="Liquidificador Branco">
                <h2>Liquidificador Branco</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="3">
                <img src="images/multiprocessador.png" alt="Multiprocessador Branco">
                <h2>Multiprocessador Branco</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="4">
                <img src="images/mixer.png" alt="Mixer Branco">
                <h2>Mixer Branco</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="5">
                <img src="images/espremedor.png" alt="Espremedor Branco">
                <h2>Espremedor Branco</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="6">
                <img src="images/assadeira.png" alt="Assadeira">
                <h2>Travessa de Forno</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="7">
                <img src="images/forma-pudim.png" alt="Travessa Pudim de Forno">
                <h2>Travessa Pudim de Forno</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="8">
                <img src="images/jarra.png" alt="Jarra de Vidro 2L">
                <h2>Jarra de Vidro 2L</h2>
                <button class="link-button">Vincular</button>
            </div>
            
            <div class="product-item" data-id="9">
                <img src="images/escorredor-macarrao.png" alt="Escorredor Macarrao">
                <h2>Escorredor Macarrao</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="10">
                <img src="images/rodo.png" alt="Rodo Branco em Bambu">
                <h2>Rodo Branco em Bambu</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="11">
                <img src="images/vassoura.png" alt="Vassoura e p√° Branco em Bambu">
                <h2>Vassoura e p√° Branco em Bambu</h2>
                <button class="link-button">Vincular</button>
            </div>      

            <div class="product-item" data-id="12">
                <img src="images/rodinho.png" alt="Rodinho Branco em Bambu">
                <h2>Rodinho Branco em Bambu</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="13">
                <img src="images/cesto.png" alt="Cesto em Bambu">
                <h2>Cesto em Bambu</h2>
                <button class="link-button">Vincular</button>
            </div>
                        
            <div class="product-item" data-id="14">
                <img src="images/pote.png" alt="Pote de Bambu 1L">
                <h2>Pote de Bambu 1L</h2>
                <button class="link-button">Vincular</button>
            </div>
            
            <div class="product-item" data-id="15">
                <img src="images/gelo-redondo.png" alt="Forma de Gelo Redondo">
                <h2>Forma de Gelo Redondo</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="16">
                <img src="images/gelo-quadrado.png" alt="Forma de Gelo Quadrado">
                <h2>Forma de Gelo Quadrado</h2>
                <button class="link-button">Vincular</button>
            </div>
            
            <div class="product-item" data-id="17">
                <img src="images/toalha-rosto.png" alt="Toalhas de Rosto Branco">
                <h2>Toalhas de Rosto Branco</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="18">
                <img src="images/travesseiro.png" alt="2 Travesseiros Nasa">
                <h2>2 Travesseiros Nasa</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="19">
                <img src="images/manta.png" alt="Manta Fleece Branca">
                <h2>Manta Fleece Branca</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="20">
                <img src="images/assadeira-bolo.png" alt="Assadeira Bolo">
                <h2>Assadeira Bolo</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="21">
                <img src="images/lixeira.png" alt="Lixeira Branca">
                <h2>Lixeira Branca 1</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="22">
                <img src="images/lixeira.png" alt="Lixeira Branca">
                <h2>Lixeira Branca 2</h2>
                <button class="link-button">Vincular</button>
            </div>

            <div class="product-item" data-id="23">
                <img src="images/lixeira.png" alt="Lixeira Branca">
                <h2>Lixeira Branca 3</h2>
                <button class="link-button">Vincular</button>
            </div>

        </section>
    </main>
    
    <footer>
        <p>Obrigada pela presen√ßa e carinho! üíï</p>
    </footer>

    <div id="vincular-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Vincular Produto</h2>
            <label for="telefone">Insira seu telefone:</label>
            <input type="text" id="telefone" name="telefone" required>
            <button id="confirm-vincular">Vincular</button>
        </div>
    </div>
    <div id="desvincular-modal" style="display:none;">
        <div class="modal-content">
            <button class="close-button">&times;</button>
            <h2>Desvincular Produto</h2>
            <input type="text" id="desvincular-telefone" placeholder="Digite seu telefone">
            <button id="confirm-desvincular">Desvincular</button>
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", async function() {
            const productData = await loadProductData();
            applyProductData(productData);
        
            const modal = document.getElementById('vincular-modal');
            const closeButton = document.querySelector('.close-button');
            const confirmButton = document.getElementById('confirm-vincular');
            const telefoneInput = document.getElementById('telefone');
            let selectedProduct = null;

            const desvincularButton = document.getElementById('desvincular-button');
            const desvincularModal = document.getElementById('desvincular-modal');
            const desvincularCloseButton = desvincularModal.querySelector('.close-button');
    const desvincularConfirmButton = document.getElementById('confirm-desvincular');
    const desvincularTelefoneInput = document.getElementById('desvincular-telefone');
        
            // Abrir modal ao clicar em "Vincular"
            document.querySelectorAll('.link-button').forEach(button => {
                button.addEventListener('click', function() {
                    selectedProduct = parseInt(this.closest('.product-item').getAttribute('data-id'));
                    modal.style.display = 'block';
                });
            });
        
            // Fechar modal
            closeButton.addEventListener('click', function() {
                modal.style.display = 'none';
                telefoneInput.value = ''; // Limpar o campo de telefone ao fechar o modal
            });
        
            // Validar o telefone enquanto o usu√°rio digita
            telefoneInput.addEventListener('input', function() {
                const telefone = telefoneInput.value;
        
                // Remove caracteres n√£o num√©ricos e limita a entrada a 11 d√≠gitos
                telefoneInput.value = telefone.replace(/[^0-9]/g, '').slice(0, 11);
        
                // Checar se o telefone tem menos de 7 n√∫meros
                if (telefoneInput.value.length < 8) {
                    telefoneInput.setCustomValidity("O telefone deve ter pelo menos 8 d√≠gitos.");
                } else {
                    telefoneInput.setCustomValidity(""); // Reseta a mensagem de erro se for v√°lida
                }
            });
        
            // Confirmar vincula√ß√£o
            confirmButton.addEventListener('click', async function() {
                const telefone = telefoneInput.value;
        
                // Se o telefone for v√°lido, prosseguir com a vincula√ß√£o
                if (telefone.length >= 7 && telefone.length <= 11) {
                    // Atualizar dados no array
                    const product = productData.find(p => p.id === selectedProduct);
                    if (product) {
                        product.telefone = telefone;
                        product.vinculado = true;
        
                        // Salvar dados atualizados no JSON
                        await saveProductData(productData);
        
                        // Reaplicar os dados para atualizar a interface
                        applyProductData(productData);
                        modal.style.display = 'none';
                        telefoneInput.value = ''; // Limpar o campo de telefone
                    }
                } else {
                    alert("Por favor, insira um telefone v√°lido com 7 a 11 d√≠gitos.");
                }
            });
        
            // Abrir modal de Desvincular Produto ao clicar no bot√£o
            desvincularButton.addEventListener('click', function() {
                desvincularModal.style.display = 'block';
            });
        
            // Fechar modal de Desvincular Produto
            desvincularCloseButton.addEventListener('click', function() {
                desvincularModal.style.display = 'none';
                desvincularTelefoneInput.value = ''; // Limpar o campo de telefone ao fechar o modal
            });
        
            // Confirmar desvincula√ß√£o
            desvincularConfirmButton.addEventListener('click', async function() {
                const telefone = desvincularTelefoneInput.value;
        
                // Se o telefone for v√°lido, prosseguir com a desvincula√ß√£o
                if (telefone.length >= 7 && telefone.length <= 11) {
                    // Desvincular produtos
                    productData.forEach(product => {
                        if (product.telefone === telefone) {
                            product.telefone = "";
                            product.vinculado = false;
                        }
                    });
        
                    // Salvar dados atualizados no JSON
                    await saveProductData(productData);
        
                    // Reaplicar os dados para atualizar a interface
                    applyProductData(productData);
                    desvincularModal.style.display = 'none';
                    desvincularTelefoneInput.value = ''; // Limpar o campo de telefone
                } else {
                    alert("Por favor, insira um telefone v√°lido com 8 a 11 d√≠gitos.");
                }
            });
        
            // Fechar modal se clicar fora da √°rea de conte√∫do
            window.addEventListener('click', function(event) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                    telefoneInput.value = ''; // Limpar o campo de telefone ao fechar o modal
                }
        
                if (event.target === desvincularModal) {
                    desvincularModal.style.display = 'none';
                    desvincularTelefoneInput.value = ''; // Limpar o campo de telefone ao fechar o modal
                }
            });
        
            // Fun√ß√£o para carregar os dados do arquivo JSON
            async function loadProductData() {
                const response = await fetch('product/products.json');
                return await response.json();
            }
        
            // Fun√ß√£o para salvar os dados no arquivo JSON
            async function saveProductData(data) {
                await fetch('product/products.json', {
                    method: 'POST', // M√©todo fict√≠cio; ajuste conforme o back-end usado
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
            }
        
            // Fun√ß√£o para aplicar os dados na interface
            function applyProductData(productData) {
                document.querySelectorAll('.product-item').forEach(item => {
                    const productId = parseInt(item.getAttribute('data-id'));
                    const product = productData.find(p => p.id === productId);
        
                    if (product && product.vinculado) {
                        item.classList.add('vinculado');
                    } else {
                        item.classList.remove('vinculado');
                    }
                });
            }
        });
        </script>
</body>
</html>
